package workflow

import (
	"github.com/danbudris/vulnerabilityProcessor/pkg/api"
	"github.com/danbudris/vulnerabilityProcessor/pkg/vexManager"
)

func NewContext() *Context {
	return &Context{
		PullRequests:    []string{},
		Issues:          []string{},
		Vulnerabilities: []*api.VulnerabilityFinding{},
		Vex:             nil,
	}
}

type Context struct {
	MessageSource   string
	FindingSource   string
	Vex             *vexManager.Manager
	PullRequests    []string
	Issues          []string
	Vulnerabilities []*api.VulnerabilityFinding
}

func (c *Context) AddIssue(i string) {
	c.Issues = append(c.Issues, i)
}

func (c *Context) AddPullRequest(pr string) {
	c.PullRequests = append(c.PullRequests, pr)
}

func (c *Context) AddVulnerabilitiy(v *api.VulnerabilityFinding) {
	c.Vulnerabilities = append(c.Vulnerabilities, v)
}

func (c *Context) SetVex(v *vexManager.Manager) {
	c.Vex = v
}
