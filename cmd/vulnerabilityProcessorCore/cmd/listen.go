package cmd

import (
	"github.com/spf13/cobra"
	"github.com/spf13/viper"
	"log"
)

var listenCmd = &cobra.Command{
	Use:   "listen",
	Short: "listen for vulnerability events",
	Long:  "Listen for vulnerability events from a particular source",
}

func init() {
	listenCmd.PersistentFlags().StringP(vexFilepathFlag, "f", "", "Filepath of the VEX document to associate with the listener")
	if err := viper.BindPFlags(listenCmd.PersistentFlags()); err != nil {
		log.Fatalf("failed to bind flags for root: %v", err)
	}
	rootCmd.AddCommand(listenCmd)
}